<!--
 * @Author: Astray
 * @Date: 2023-04-17 17:15:55
 * @LastEditors: Astray bitcreate@qq.com
 * @LastEditTime: 2023-04-20 21:15:46
 * @FilePath: \Code\09. JavaScript语言提升\06. Promise基础\练习题\p2.html
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div class="container"></div>
    <p class="label"></p>
    <script>
      const imgUrl =
        "https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fblog%2F202106%2F09%2F20210609081952_51ef5.thumb.1000_0.jpg&refer=http%3A%2F%2Fc-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1684588058&t=8cc15a12374f789ee09301f59d2755f9";
      const container = document.querySelector(".container");
      const label = document.querySelector(".label");
      // 根据指定的图片路径，创建一个img元素
      // 该函数需要返回一个Promise，当图片加载完成后，任务完成，若图片加载失败，任务失败
      // 任务完成后，需要提供的数据是图片DOM元素；任务失败时，需要提供失败的原因
      // 提示：img元素有两个事件，load事件会在图像加载完成时触发，error事件会在图像加载失败时触发
      function createImage(imgUrl) {
        return new Promise((resolve, reject) => {
          const img = document.createElement("img");
          img.src = imgUrl;
          img.onload = () => resolve(img);
          img.onerror = (e) => reject(e);
        });
      }

      // 使用createImage函数创建一个图像，图像路径自行定义
      // 当图像成功加载后，将图像宽高显示在p元素中，当图像加载失败后，输出加载失败的原因

      createImage(imgUrl).then(
        (img) => {
          label.innerText = `weight = ${img.width}, height = ${img.height}`;
        },
        (err) => {
          console.log(err);
        }
      );
      // 使用createImage函数创建一个图像，图像路径自行定义
      // 当图像成功加载后，将图像元素加入到container容器中，当图像加载失败后，输出加载失败的原因
      createImage(imgUrl).then(
        (img) => {
          container.appendChild(img);
        },
        (err) => {
          console.log(err);
        }
      );
    </script>
  </body>
</html>
